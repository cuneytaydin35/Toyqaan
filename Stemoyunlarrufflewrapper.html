<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Ruffle Wrapper (Dinamik + Fullscreen + Autoplay)</title>
  <script src="https://unpkg.com/@ruffle-rs/ruffle"></script>
  <style>
    :root { --w: 800; --h: 600; }
    html, body { height:100%; margin:0; background:transparent; }

    .ruffle-wrap {
      position:relative; width:100%; max-width:100vw;
      aspect-ratio: calc(var(--w)/var(--h));
      background:transparent; overflow:hidden;
    }
    .ruffle-wrap ruffle-player,
    .ruffle-wrap .ruffle-player {
      width:100%; height:100%; display:block;
      background:transparent!important;
    }

    .controls { text-align:right; padding:10px 15px 0 0; }
    .fs-btn {
      padding:10px 14px; font:600 14px system-ui;
      background:rgba(0,0,0,.55); color:#fff;
      border:0; border-radius:12px; cursor:pointer;
    }

    .ruffle-wrap:fullscreen,
    .ruffle-wrap:-webkit-full-screen {
      width:100vw!important; height:100vh!important;
      max-width:none; aspect-ratio:auto;
    }
  </style>
</head>
<body>
  <div class="ruffle-wrap" id="ruffleWrap" style="--w:800;--h:600;">
    <ruffle-player id="rufflePlayer"></ruffle-player>
  </div>
  <div class="controls">
    <button class="fs-btn" id="fsBtn" type="button">Tam ekran</button>
  </div>

  <script>
    (function(){
      const ruffle = window.RufflePlayer?.newest() || window.RufflePlayer;
      const wrap = document.getElementById('ruffleWrap');
      const placeholder = document.getElementById('rufflePlayer');
      const player = ruffle.createPlayer();
      placeholder.replaceWith(player);

      // URL parametresinden SWF seç
      const params = new URLSearchParams(window.location.search);
      const file = params.get("file") || "your.swf";

      // SWF'i yükle
      player.load({ url: file }).then(() => {
        // Yüklenince otomatik başlatmayı dene
        player.play().catch(err => {
          console.warn("Autoplay engellendi, kullanıcı etkileşimi bekleniyor.", err);
        });
      });

      // Tam ekran butonu
      const fsBtn = document.getElementById('fsBtn');
      fsBtn.onclick = async () => {
        if (!document.fullscreenElement) {
          await wrap.requestFullscreen();
        } else {
          await document.exitFullscreen();
        }
      };
      document.addEventListener("fullscreenchange", ()=>{
        fsBtn.textContent = document.fullscreenElement ? "Çıkış" : "Tam ekran";
      });
    })();
  </script>
</body>
</html>
